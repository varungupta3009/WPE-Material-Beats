var c=0,d=0,f=15,g=!0,l=!0,n=!0,p=1,q=.5,r=[];function t(){r=[];c=Math.floor(Math.floor(u.width*u.height/5E3)*p/4);for(var a=0;a<c;a++)r.push(new v)}window.h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};var w=Array(32),x=Array(32);window.wallpaperRegisterAudioListener&&window.wallpaperRegisterAudioListener(function(a){for(var b=0;32>b;b++)w[b]=Math.floor(50*(a[b]+a[b+32])),x[b]=Math.floor(50*(a[b+64]+a[b+96]))});var u=document.getElementById("canvas"),y=u.getContext("2d");
u.width=window.innerWidth;u.height=window.innerHeight;
window.wallpaperPropertyListener={applyUserProperties:function(a){a.background_color&&(u.style.backgroundColor="rgb("+a.background_color.value.split(" ").map(function(b){return Math.ceil(255*b)})+")");a.background_image&&(a.background_image.value?(u.style.backgroundImage="url(file:///"+a.background_image.value+")",u.style.backgroundSize="100% 100%"):u.style.backgroundImage="none");a.show_shapes&&(g=a.show_shapes.value,a.shape_density&&(p=a.shape_density.value,t()),a.shape_size&&(f=a.shape_size.value/1.5),a.pulse_on_beats&&(n=a.pulse_on_beats.value),
a.pulse_smoothness&&(q=1-a.pulse_smoothness.value/10),a.move_on_bass&&(l=a.move_on_bass.value))}};
function v(){this.type=.5>Math.random();this.rotation=.5>Math.random();this.index=d++;this.x=Math.random()*u.width;this.y=Math.random()*u.height;this.a=-.5+Math.random();this.b=-.5+Math.random();this.i=2.5*(.01*Math.floor(90*Math.random())+.1)+.5;this.c=0;this.color=["#4285F4","#EA4335","#FBBC05","#34A853"][this.index%4];this.f=this.type?2*Math.PI:Math.round(100*Math.random())/200*Math.PI;this.g=this.type?0:(Math.round(100*Math.random())/200+1)*Math.PI;d%=32}
function z(a){var b=a.x<u.width/2?w:x,k=l?Math.min(Math.max(.12*b.slice(1,6).reduce(function(A,B){return A+B},0),.5),5):.5,e=a.c+(a.type?0:5);a.x+=a.a*k;a.y+=a.b*k;a.x>=u.width-e?(a.x=u.width-e,a.a=-a.a):a.x<=e&&(a.x=e,a.a=-a.a);a.y>=u.height-e?(a.y=u.height-e,a.b=-a.b):a.y<=e&&(a.y=e,a.b=-a.b);a.type||(a.f+=(a.rotation?.01:-.01)*k,a.g+=(a.rotation?.01:-.01)*k);b=b[a.index]/20;if(!b||1>b||!n)b=1;b=Math.min(a.i*b,4)*f;a.c&&1!==q&&(b=b*q+a.c*(1-q));y.lineWidth=10;y.beginPath();a.type?y.fillStyle=a.color:
y.strokeStyle=a.color;y.arc(a.x,a.y,b,a.f,a.g,!1);a.type?y.fill():y.stroke();1!==q&&(a.c=b)}window.onload=function(){y.clearRect(0,0,u.width,u.height);for(var a=0;a<c;a++)g&&z(r[a]);window.h(window.onload)};window.onresize=function(){u.width=window.innerWidth;u.height=window.innerHeight;c=Math.floor(u.width*u.height/5E3);t()};window.onresize();